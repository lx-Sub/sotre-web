(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-30b2ac3e"],{"408c":function(e,t,a){"use strict";a("d8db")},"53a6":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"material-approval"},[t("el-dialog",{attrs:{title:"add"===e.dialogForm.type?"新增材料审批":"编辑材料审批",visible:e.dialogForm.isShow},on:{"update:visible":function(t){return e.$set(e.dialogForm,"isShow",t)}}},[t("el-form",{ref:"dialogForm",attrs:{"label-width":"120px",model:e.dialogForm.formData,rules:e.dialogForm.rules}},[t("el-form-item",{attrs:{label:"审批人",prop:"approver"}},[t("el-input",{attrs:{placeholder:"请输入审批人姓名"},model:{value:e.dialogForm.formData.approver,callback:function(t){e.$set(e.dialogForm.formData,"approver",t)},expression:"dialogForm.formData.approver"}})],1),t("el-form-item",{attrs:{label:"材料名称",prop:"materialName"}},[t("el-input",{attrs:{placeholder:"请输入材料名称"},model:{value:e.dialogForm.formData.materialName,callback:function(t){e.$set(e.dialogForm.formData,"materialName",t)},expression:"dialogForm.formData.materialName"}})],1),t("el-form-item",{attrs:{label:"数量",prop:"quantity"}},[t("el-input-number",{attrs:{min:1,placeholder:"请输入材料数量"},model:{value:e.dialogForm.formData.quantity,callback:function(t){e.$set(e.dialogForm.formData,"quantity",t)},expression:"dialogForm.formData.quantity"}})],1),t("el-form-item",{attrs:{label:"申请日期",prop:"applyDate"}},[t("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.dialogForm.formData.applyDate,callback:function(t){e.$set(e.dialogForm.formData,"applyDate",t)},expression:"dialogForm.formData.applyDate"}})],1),t("el-form-item",{attrs:{label:"备注",prop:"description"}},[t("el-input",{attrs:{type:"textarea",placeholder:"请输入备注"},model:{value:e.dialogForm.formData.description,callback:function(t){e.$set(e.dialogForm.formData,"description",t)},expression:"dialogForm.formData.description"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogForm.isShow=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确定")])],1)],1),t("div",{staticStyle:{"margin-bottom":"10px"}},[t("el-button",{attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v("新增材料审批")]),t("el-popconfirm",{staticStyle:{"margin-left":"10px"},attrs:{"confirm-button-text":"确定","cancel-button-text":"我再想想",title:"你确定删除吗？"},on:{confirm:e.handleDeleteBatch}},[t("el-button",{attrs:{slot:"reference",type:"danger"},slot:"reference"},[e._v(" 批量删除 ")])],1)],1),t("div",{staticClass:"search-form"},[t("el-form",{attrs:{"label-width":"auto",model:e.searchForm.formData,inline:!0}},[t("el-form-item",{attrs:{label:"审批人",prop:"approver"}},[t("el-input",{attrs:{placeholder:"请输入审批人姓名","prefix-icon":"el-icon-search"},model:{value:e.searchForm.formData.approver,callback:function(t){e.$set(e.searchForm.formData,"approver","string"===typeof t?t.trim():t)},expression:"searchForm.formData.approver"}})],1),t("el-form-item",{attrs:{label:"申请日期",prop:"applyDate"}},[t("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.searchForm.formData.applyDate,callback:function(t){e.$set(e.searchForm.formData,"applyDate",t)},expression:"searchForm.formData.applyDate"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("搜索")]),t("el-button",{on:{click:e.reset}},[e._v("重置")])],1)],1)],1),t("div",{staticClass:"common-table"},[t("el-table",{attrs:{data:e.table.tableData,border:"",stripe:"",height:"85%","row-key":"id","header-cell-style":{background:"#eef1f6",color:"#606266",textAlign:"center",fontWeight:"bold",borderWidth:"3px"}},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55"}}),t("el-table-column",{attrs:{prop:"id",label:"审批单ID",width:"120"}}),t("el-table-column",{attrs:{prop:"materialName",label:"材料名称",width:"120"}}),t("el-table-column",{attrs:{prop:"quantity",label:"数量",width:"120"}}),t("el-table-column",{attrs:{prop:"applyDate",label:"申请日期",width:"150"}}),t("el-table-column",{attrs:{prop:"approver",label:"审批人",width:"120"}}),t("el-table-column",{attrs:{prop:"description",label:"备注",width:"200"}}),t("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"200"}}),t("el-table-column",{attrs:{prop:"updateTime",label:"修改时间",width:"200"}}),t("el-table-column",{attrs:{prop:"status",label:"审批状态",width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[0===a.row.status?t("span",[e._v("未审批")]):e._e(),1===a.row.status?t("span",[e._v("审批通过")]):e._e(),-1===a.row.status?t("span",[e._v("审批失败")]):e._e()])]}}])}),t("el-table-column",{attrs:{label:"操作",width:"500",fixed:"right",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"primary",disabled:0!==a.row.status},on:{click:function(t){return e.approve(a.row)}}},[e._v("同意")]),t("el-button",{attrs:{type:"danger",disabled:0!==a.row.status},on:{click:function(t){return e.reject(a.row)}}},[e._v("驳回")])]}}])})],1)],1),t("el-pagination",{staticClass:"pagination",attrs:{layout:"total, sizes, prev, pager, next",total:e.table.pageConfig.total,"page-size":e.table.pageConfig.size,"current-page":e.table.pageConfig.current,"page-sizes":[5,10,15,20]},on:{"update:currentPage":function(t){return e.$set(e.table.pageConfig,"current",t)},"update:current-page":function(t){return e.$set(e.table.pageConfig,"current",t)},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},o=[],l=a("bc3a"),i=a.n(l),s=a("b775");const n="/dev/expenses",p="/expenses",c=e=>i.a.get(n,{params:e}).then(e=>e.data).catch(e=>{throw console.error("获取报销单列表失败",e),e}),d=e=>i.a.post(n,e).then(e=>e.data).catch(e=>{throw console.error("新增报销单失败",e),e}),m=e=>i.a.put(n,e).then(e=>e.data).catch(e=>{throw console.error("编辑报销单失败",e),e}),h=e=>Object(s["a"])({url:p+"/batch/"+e,method:"delete"});var g={data(){return{dialogForm:{type:"add",isShow:!1,formData:{},rules:{approver:[{required:!0,message:"请输入审批人姓名",trigger:"blur"}],materialName:[{required:!0,message:"请输入材料名称",trigger:"blur"}],quantity:[{required:!0,message:"请输入材料数量",trigger:"blur"}],applyDate:[{required:!0,message:"请选择申请日期",trigger:"blur"}]}},searchForm:{formData:{}},table:{tableData:[],pageConfig:{total:0,current:1,size:10},ids:[]},loadingFlag:!1}},methods:{approve(e){e.status=1,m(e).then(e=>{200===e.code?(this.$message.success("审批通过"),this.loading()):this.$message.error("审批失败")})},reject(e){e.status=-1,m(e).then(e=>{200===e.code?(this.$message.success("驳回成功"),this.loading()):this.$message.error("驳回失败")})},loading(){c({current:this.table.pageConfig.current,size:this.table.pageConfig.size,approver:this.searchForm.formData.approver,applyDate:this.searchForm.formData.applyDate}).then(e=>{this.table.tableData=e.data,this.table.pageConfig.total=e.total})},handleAdd(){this.dialogForm.isShow=!0,this.dialogForm.type="add",this.dialogForm.formData={}},confirm(){this.$refs.dialogForm.validate(e=>{e&&(this.loadingFlag=!0,"add"===this.dialogForm.type?d(this.dialogForm.formData).then(e=>{this.loadingFlag=!1,200===e.code?(this.$message.success("新增成功!"),this.dialogForm.isShow=!1,this.loading()):this.$message.error("新增失败!")}):m(this.dialogForm.formData).then(e=>{this.loadingFlag=!1,200===e.code?(this.$message.success("修改成功!"),this.dialogForm.isShow=!1,this.loading()):this.$message.error("修改失败!")}))})},handleSelectionChange(e){console.log("Selected rows:",e),this.ids=e.map(e=>e.id),console.log("Selected ids:",this.ids)},handleDeleteBatch(){h(this.ids).then(e=>{200===e.code?(this.$message.success("批量删除成功！"),this.loading()):this.$message.error("批量删除失败！")})},search(){this.loading()},reset(){this.searchForm.formData={},this.loading()},handleSizeChange(e){this.table.pageConfig.size=e,this.loading()},handleCurrentChange(e){this.table.pageConfig.current=e,this.loading()}},mounted(){this.loading()}},u=g,f=(a("408c"),a("2877")),b=Object(f["a"])(u,r,o,!1,null,"13f4ae76",null);t["default"]=b.exports},d8db:function(e,t,a){}}]);
//# sourceMappingURL=chunk-30b2ac3e.95ff16a0.js.map