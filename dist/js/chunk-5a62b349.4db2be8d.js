(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5a62b349"],{"97a3":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"manage"},[t("el-dialog",{attrs:{title:"add"===e.dialogForm.type?"新增角色":"更新角色",visible:e.dialogForm.isShow},on:{"update:visible":function(t){return e.$set(e.dialogForm,"isShow",t)}}},[t("el-form",{ref:"form",attrs:{"label-width":"100px",model:e.dialogForm.formData}},[t("el-form-item",{staticStyle:{"margin-bottom":"4px"},attrs:{"label-width":"40px"}},[t("el-form-item",{staticStyle:{display:"inline-block"},attrs:{label:"编号",prop:"code"}},[t("el-input",{attrs:{placeholder:"请输入编号"},model:{value:e.dialogForm.formData.code,callback:function(t){e.$set(e.dialogForm.formData,"code","string"===typeof t?t.trim():t)},expression:"dialogForm.formData.code"}})],1),t("el-form-item",{staticStyle:{display:"inline-block"},attrs:{label:"职称",prop:"name"}},[t("el-input",{attrs:{placeholder:"请输入职称"},model:{value:e.dialogForm.formData.name,callback:function(t){e.$set(e.dialogForm.formData,"name","string"===typeof t?t.trim():t)},expression:"dialogForm.formData.name"}})],1)],1),t("el-form-item",{staticStyle:{width:"450px"},attrs:{label:"备注","label-width":"140px",prop:"remark"}},[t("el-input",{attrs:{type:"textarea",placeholder:"请输入",autosize:{minRows:2,maxRows:4},maxlength:"100","show-word-limit":""},model:{value:e.dialogForm.formData.remark,callback:function(t){e.$set(e.dialogForm.formData,"remark","string"===typeof t?t.trim():t)},expression:"dialogForm.formData.remark"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogForm.isShow=!1}}},[e._v(" 取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v(" 确定")])],1)],1),t("el-dialog",{attrs:{title:"菜单分配",visible:e.menuDialog.isShow},on:{"update:visible":function(t){return e.$set(e.menuDialog,"isShow",t)}}},[t("el-tree",{ref:"tree",attrs:{props:e.menuDialog.props,data:e.menuDialog.menuData,"node-key":"id","show-checkbox":"","default-expand-all":""},scopedSlots:e._u([{key:"default",fn:function({node:a,data:o}){return t("span",{staticClass:"custom-tree-node"},[t("span",[t("i",{class:"iconfont icon-r-"+o.icon}),e._v(" "+e._s(o.name))])])}}])}),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.menuDialog.isShow=!1}}},[e._v(" 取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleSetMenu}},[e._v(" 确定")])],1)],1),t("div",{staticStyle:{"margin-bottom":"10px"}},[t("el-upload",{staticStyle:{display:"inline-block"},attrs:{action:e.importApi,headers:e.headers,accept:"xlsx","show-file-list":!1,"on-success":e.handleImportSuccess,multiple:!1}},[t("el-button",{attrs:{type:"success"}},[e._v(" 导入 ")])],1),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"warning"},on:{click:e.exportData}},[e._v(" 导出 ")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v(" 新增 ")]),t("el-popconfirm",{staticStyle:{"margin-left":"10px"},attrs:{"confirm-button-text":"确定","cancel-button-text":"我再想想",title:"你确定删除吗？"},on:{confirm:e.handleDeleteBatch}},[t("el-button",{attrs:{slot:"reference",type:"danger"},slot:"reference"},[e._v(" 批量删除 ")])],1),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:e.search}},[e._v(" 搜索")]),t("el-button",{attrs:{type:"danger"},on:{click:e.reset}},[e._v(" 重置")])],1),t("div",{staticClass:"manage-header"},[t("el-form",{attrs:{"label-width":"auto",model:e.searchForm.formData,inline:!0}},[t("el-form-item",{attrs:{label:"职称",prop:"name"}},[t("el-input",{attrs:{placeholder:"请输入职称","prefix-icon":"el-icon-search"},model:{value:e.searchForm.formData.name,callback:function(t){e.$set(e.searchForm.formData,"name","string"===typeof t?t.trim():t)},expression:"searchForm.formData.name"}})],1)],1)],1),t("div",{staticClass:"common-table"},[t("el-table",{attrs:{data:e.table.tableData,height:"85%",border:"",stripe:"","row-key":"id","header-cell-style":{background:"#eef1f6",color:"#606266",textAlign:"center",fontWeight:"bold",borderWidth:"3px"}},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"50",align:"center"}}),t("el-table-column",{attrs:{prop:"code",label:"编号","min-width":"80",align:"center"}}),t("el-table-column",{attrs:{prop:"name",label:"职称","min-width":"80",align:"center"}}),t("el-table-column",{attrs:{prop:"remark",label:"备注","min-width":"200",align:"center"}}),t("el-table-column",{attrs:{label:"操作",width:"420",fixed:"right",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit(a.row)}}},[e._v(" 编辑")]),t("el-popconfirm",{staticStyle:{"margin-left":"10px","margin-right":"10px"},attrs:{"confirm-button-text":"确定","cancel-button-text":"我再想想",title:"你确定删除吗？"},on:{confirm:function(t){return e.handleDelete(a.row.id)}}},[t("el-button",{attrs:{slot:"reference",type:"danger"},slot:"reference"},[e._v(" 删除")])],1),t("el-button",{attrs:{type:"warning"},on:{click:function(t){return e.selectMenu(a.row.id)}}},[e._v(" 分配菜单")])]}}])})],1),t("el-pagination",{staticClass:"pager",attrs:{layout:"total,sizes,prev,pager,next,jumper","page-size":e.table.pageConfig.size?e.table.pageConfig.size:10,"page-sizes":[5,10,15,20],total:e.table.pageConfig.total,"current-page":e.table.pageConfig.current},on:{"update:currentPage":function(t){return e.$set(e.table.pageConfig,"current",t)},"update:current-page":function(t){return e.$set(e.table.pageConfig,"current",t)},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},r=[],i=(a("14d9"),a("cc5e")),n=a("1f27"),l=a("2f62"),s={name:"Role",data(){return{dialogForm:{type:"add",isShow:!1,formData:{}},searchForm:{formData:{}},menuDialog:{isShow:!1,menuData:[],props:{label:"name"}},table:{tableData:[],pageConfig:{total:10,current:1,size:10}},ids:[],roleId:0}},computed:{...Object(l["b"])("token",["token"]),headers(){return{token:this.token}},importApi(){return Object(i["g"])()}},methods:{handleAdd(){this.dialogForm.isShow=!0,this.dialogForm.type="add",this.dialogForm.formData={}},handleDelete(e){Object(i["c"])(e).then(e=>{200===e.code?(this.$message.success("删除成功！"),this.loading()):this.$message.error("删除失败！")})},handleDeleteBatch(){Object(i["b"])(this.ids).then(e=>{200===e.code?(this.$message.success("批量删除成功！"),this.loading()):this.$message.error("批量删除失败！")})},handleEdit(e){this.dialogForm.isShow=!0,this.dialogForm.type="edit",this.dialogForm.formData=e},confirm(){"add"===this.dialogForm.type?Object(i["a"])(this.dialogForm.formData).then(e=>{200===e.code?(this.$message.success("添加成功！"),this.dialogForm.isShow=!1,this.loading()):this.$message.error("添加失败！")}):Object(i["d"])(this.dialogForm.formData).then(e=>{200===e.code?(this.$message.success("修改成功！"),this.dialogForm.isShow=!1,this.loading()):this.$message.error("修改失败！")})},search(){this.loading()},reset(){this.searchForm.formData={},this.loading()},handleSizeChange(e){this.table.pageConfig.size=e,this.loading()},handleCurrentChange(e){this.table.pageConfig.current=e,this.loading()},handleSelectionChange(e){this.ids=e.map(e=>e.id)},loading(){Object(i["h"])({current:this.table.pageConfig.current,size:this.table.pageConfig.size,name:this.searchForm.formData.name}).then(e=>{200===e.code?(this.table.tableData=e.data.list,this.table.pageConfig.total=e.data.total):this.$message.error(e.message)})},exportData(){window.open(Object(i["f"])())},handleImportSuccess(e){200===e.code?(this.$message.success("数据导入成功！"),this.loading()):this.$message.error("数据导入失败！")},selectMenu(e){this.menuDialog.isShow=!0,this.roleId=e,Object(n["e"])().then(e=>{200===e.code?(this.menuDialog.menuData=e.data,Object(i["i"])(this.roleId).then(e=>{if(200===e.code){const t=[];e.data.forEach(e=>{this.$refs.tree.getNode(e.menuId)&&this.$refs.tree.getNode(e.menuId).isLeaf&&t.push(e.menuId)}),this.$refs.tree.setCheckedKeys(t)}else this.$message.error("获取数据失败！")})):this.$message.error("获取数据失败！")})},handleSetMenu(){Object(i["j"])(this.roleId,this.$refs.tree.getCheckedKeys().concat(this.$refs.tree.getHalfCheckedKeys())).then(e=>{200===e.code?(this.menuDialog.isShow=!1,this.$message.success("设置菜单成功！")):this.$message.error("设置菜单失败！")})}},created(){this.loading()}},c=s,d=a("2877"),m=Object(d["a"])(c,o,r,!1,null,null,null);t["default"]=m.exports},cc5e:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return n})),a.d(t,"b",(function(){return l})),a.d(t,"d",(function(){return s})),a.d(t,"h",(function(){return c})),a.d(t,"e",(function(){return d})),a.d(t,"g",(function(){return m})),a.d(t,"f",(function(){return h})),a.d(t,"j",(function(){return u})),a.d(t,"i",(function(){return g}));var o=a("b775");const r="/role",i=e=>Object(o["a"])({url:r,method:"post",data:e}),n=e=>Object(o["a"])({url:r+"/"+e,method:"delete"}),l=e=>Object(o["a"])({url:r+"/batch/"+e,method:"delete"}),s=e=>Object(o["a"])({url:r,method:"put",data:e}),c=e=>Object(o["a"])({url:r,method:"get",params:e}),d=()=>Object(o["a"])({url:r+"/all"}),m=()=>"http://localhost:9271"+r+"/import",h=()=>"http://localhost:9271"+r+"/export",u=(e,t)=>Object(o["a"])({url:r+"/menu/"+e,method:"post",data:t}),g=e=>Object(o["a"])({url:r+"/menu/"+e})}}]);
//# sourceMappingURL=chunk-5a62b349.4db2be8d.js.map