{"version":3,"sources":["webpack:///./src/views/attendance/performance/index.vue","webpack:///./src/api/attendance.js","webpack:///src/views/attendance/performance/index.vue","webpack:///./src/views/attendance/performance/index.vue?f598","webpack:///./src/views/attendance/performance/index.vue?3b8d","webpack:///./src/views/attendance/performance/index.vue?92dd","webpack:///./src/api/dept.js"],"names":["render","_vm","this","_c","_self","staticClass","attrs","dialog","isShow","on","$event","$set","model","value","status","callback","$$v","expression","_l","statusList","item","index","key","message","slot","_v","confirm","staticStyle","importApi","headers","handleImportSuccess","exportData","search","reset","searchForm","formData","name","trim","deptId","deptList","option","id","disabled","month","table","tableData","background","color","textAlign","fontWeight","borderWidth","dayNum","scopedSlots","_u","fn","scope","changeStatus","row","attendanceList","tagType","_s","pageConfig","size","total","current","handleSizeChange","handleCurrentChange","staticRenderFns","url","getList","params","request","method","getAll","getByStaffIdAndDate","date","setAttendance","data","getImportApi","getExportApi","computed","mapState","token","methods","then","response","code","loading","$message","success","error","i","staffId","attendanceDate","getAllDept","list","forEach","dept","children","length","push","subDept","console","log","window","open","setTimeout","created","component","add","deleteOne","deleteBatch","ids","edit"],"mappings":"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","file":"js/chunk-f8739522.536d84e4.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"manage\"},[_c('el-dialog',{attrs:{\"title\":\"考勤状态\",\"visible\":_vm.dialog.isShow},on:{\"update:visible\":function($event){return _vm.$set(_vm.dialog, \"isShow\", $event)}}},[_c('el-radio-group',{model:{value:(_vm.dialog.status),callback:function ($$v) {_vm.$set(_vm.dialog, \"status\", $$v)},expression:\"dialog.status\"}},_vm._l((_vm.dialog.statusList),function(item,index){return _c('el-radio',{key:index,attrs:{\"label\":item.message,\"border\":\"\"}})}),1),_c('div',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.dialog.isShow = false}}},[_vm._v(\" 取消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.confirm}},[_vm._v(\" 确定\")])],1)],1),_c('div',{staticStyle:{\"margin-bottom\":\"10px\"}},[_c('el-upload',{staticStyle:{\"display\":\"inline-block\"},attrs:{\"action\":_vm.importApi,\"headers\":_vm.headers,\"accept\":\"xlsx\",\"show-file-list\":false,\"on-success\":_vm.handleImportSuccess,\"multiple\":false}},[_c('el-button',{attrs:{\"type\":\"success\"}},[_vm._v(\" 导入 \")])],1),_c('el-button',{staticStyle:{\"margin-left\":\"10px\"},attrs:{\"type\":\"warning\"},on:{\"click\":_vm.exportData}},[_vm._v(\" 导出 \")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.search}},[_vm._v(\" 搜索\")]),_c('el-button',{attrs:{\"type\":\"danger\"},on:{\"click\":_vm.reset}},[_vm._v(\" 重置\")])],1),_c('div',{staticClass:\"manage-header\"},[_c('el-form',{attrs:{\"label-width\":\"auto\",\"model\":_vm.searchForm.formData,\"inline\":true}},[_c('el-form-item',{attrs:{\"label\":\"姓名\",\"prop\":\"name\"}},[_c('el-input',{attrs:{\"placeholder\":\"请输入姓名\",\"prefix-icon\":\"el-icon-search\"},model:{value:(_vm.searchForm.formData.name),callback:function ($$v) {_vm.$set(_vm.searchForm.formData, \"name\", (typeof $$v === 'string'? $$v.trim(): $$v))},expression:\"searchForm.formData.name\"}})],1),_c('el-form-item',{attrs:{\"label\":\"部门\",\"prop\":\"deptId\"}},[_c('el-select',{attrs:{\"placeholder\":\"请选择部门\"},model:{value:(_vm.searchForm.formData.deptId),callback:function ($$v) {_vm.$set(_vm.searchForm.formData, \"deptId\", $$v)},expression:\"searchForm.formData.deptId\"}},_vm._l((_vm.searchForm.deptList),function(option){return _c('el-option',{key:option.id,attrs:{\"label\":option.name,\"value\":option.id,\"disabled\":option.disabled}})}),1)],1),_c('el-form-item',{attrs:{\"label\":\"月份\",\"prop\":\"month\"}},[_c('el-date-picker',{attrs:{\"value-format\":\"yyyyMM\",\"type\":\"month\",\"placeholder\":\"请选择月份\"},model:{value:(_vm.searchForm.formData.month),callback:function ($$v) {_vm.$set(_vm.searchForm.formData, \"month\", $$v)},expression:\"searchForm.formData.month\"}})],1)],1)],1),_c('div',{staticClass:\"common-table\"},[_c('el-table',{attrs:{\"data\":_vm.table.tableData,\"height\":\"85%\",\"border\":\"\",\"stripe\":\"\",\"row-key\":\"id\",\"header-cell-style\":{\n    background: '#eef1f6', color: '#606266',\n    textAlign: 'center', fontWeight: 'bold', borderWidth: '3px'\n  }}},[_c('el-table-column',{attrs:{\"prop\":\"staffId\",\"label\":\"员工id\",\"min-width\":\"80\",\"align\":\"center\"}}),_c('el-table-column',{attrs:{\"prop\":\"code\",\"label\":\"工号\",\"min-width\":\"125\",\"align\":\"center\"}}),_c('el-table-column',{attrs:{\"prop\":\"name\",\"label\":\"姓名\",\"min-width\":\"125\",\"align\":\"center\"}}),_c('el-table-column',{attrs:{\"prop\":\"deptName\",\"label\":\"部门\",\"min-width\":\"125\",\"align\":\"center\"}}),_c('el-table-column',{attrs:{\"prop\":\"phone\",\"label\":\"电话\",\"min-width\":\"125\",\"align\":\"center\"}}),_vm._l((_vm.dayNum),function(index){return _c('el-table-column',{key:index,attrs:{\"label\":index + '日',\"min-width\":\"55\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('div',{on:{\"click\":function($event){return _vm.changeStatus(scope.row, index - 1)}}},[_c('el-tag',{attrs:{\"type\":scope.row.attendanceList[index - 1].tagType}},[_vm._v(\" \"+_vm._s(scope.row.attendanceList[index - 1].message)+\" \")])],1)]}}],null,true)})})],2),_c('el-pagination',{staticClass:\"pager\",attrs:{\"layout\":\"total,sizes,prev,pager,next,jumper\",\"page-size\":_vm.table.pageConfig.size ? _vm.table.pageConfig.size : 10,\"page-sizes\":[5, 10, 15, 20],\"total\":_vm.table.pageConfig.total,\"current-page\":_vm.table.pageConfig.current},on:{\"update:currentPage\":function($event){return _vm.$set(_vm.table.pageConfig, \"current\", $event)},\"update:current-page\":function($event){return _vm.$set(_vm.table.pageConfig, \"current\", $event)},\"size-change\":_vm.handleSizeChange,\"current-change\":_vm.handleCurrentChange}})],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import request from '../utils/request'\n\nconst url = '/attendance'\n\n/**\n * 添加\n * @param data\n * @returns {AxiosPromise}\n */\nexport const add = (data) => {\n  return request({\n    url: url, method: 'post', data\n  })\n}\n\n/**\n * 逻辑删除\n * @param id\n * @returns {AxiosPromise}\n */\nexport const deleteOne = (id) => {\n  return request({\n    url: url + '/' + id, method: 'delete'\n  })\n}\n\nexport const deleteBatch = (ids) => {\n  return request({\n    url: url + '/batch/' + ids, method: 'delete'\n  })\n}\n\nexport const edit = (data) => {\n  return request({\n    url: url, method: 'put', data\n  })\n}\n\n// 分页条件查询\nexport const getList = (params) => {\n  return request({\n    url: url, method: 'get', params\n  })\n}\n\n// 查询所有\nexport const getAll = () => {\n  return request({\n    url: url + '/all'\n  })\n}\n\n// 得到一条数据\nexport const getOne = (id) => {\n  return request({\n    url: url + '/' + id\n  })\n}\n\nexport const getByStaffIdAndDate = (id, date) => {\n  return request({\n    url: url + '/staff/' + id + '/' + date\n  })\n}\n\n// 设置社保\nexport const setAttendance = (data) => {\n  return request({\n    url: url + '/set', method: 'put', data\n  })\n}\n\n// 得到一条数据\n// 数据导入\nexport const getImportApi = () => {\n  return 'http://localhost:' + process.env.VUE_APP_PORT + url + '/import'\n}\n\n// 数据导出\nexport const getExportApi = (month) => {\n  return 'http://localhost:' + process.env.VUE_APP_PORT + url + '/export/' + month\n}\n","<template>\n  <div class=\"manage\">\n\n    <el-dialog title=\"考勤状态\" :visible.sync=\"dialog.isShow\">\n      <el-radio-group v-model=\"dialog.status\">\n        <el-radio v-for=\"(item, index) in dialog.statusList\" :key=\"index\" :label=\"item.message\" border />\n      </el-radio-group>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"dialog.isShow = false\"> 取消</el-button>\n        <el-button type=\"primary\" @click=\"confirm\"> 确定</el-button>\n      </div>\n    </el-dialog>\n\n    <!--操作-->\n    <div style=\"margin-bottom: 10px\">\n      <el-upload :action=\"importApi\" :headers=\"headers\" accept=\"xlsx\" :show-file-list=\"false\"\n        :on-success=\"handleImportSuccess\" :multiple=\"false\" style=\"display:inline-block\">\n        <el-button type=\"success\"> 导入\n        </el-button>\n      </el-upload>\n      <el-button type=\"warning\" @click=\"exportData\" style=\"margin-left: 10px\"> 导出\n      </el-button>\n\n      <el-button type=\"primary\" @click=\"search\"> 搜索</el-button>\n      <el-button type=\"danger\" @click=\"reset\"> 重置</el-button>\n    </div>\n\n    <!---------------------- 搜索 ----------------------------->\n    <div class=\"manage-header\">\n      <el-form label-width=\"auto\" :model=\"searchForm.formData\" :inline=\"true\">\n        <el-form-item label=\"姓名\" prop=\"name\">\n          <el-input placeholder=\"请输入姓名\" v-model.trim=\"searchForm.formData.name\" prefix-icon=\"el-icon-search\" />\n        </el-form-item>\n        <el-form-item label=\"部门\" prop=\"deptId\">\n          <el-select placeholder=\"请选择部门\" v-model=\"searchForm.formData.deptId\">\n            <el-option v-for=\"option in searchForm.deptList\" :key=\"option.id\" :label=\"option.name\" :value=\"option.id\"\n              :disabled=\"option.disabled\" />\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"月份\" prop=\"month\">\n          <el-date-picker value-format='yyyyMM' type=\"month\" placeholder='请选择月份' v-model=\"searchForm.formData.month\" />\n        </el-form-item>\n      </el-form>\n    </div>\n    <!-------------------------- 数据表格 ---------------------------------->\n    <div class=\"common-table\">\n      <el-table :data=\"table.tableData\" height=\"85%\" border stripe row-key=\"id\" :header-cell-style=\"{\n      background: '#eef1f6', color: '#606266',\n      textAlign: 'center', fontWeight: 'bold', borderWidth: '3px'\n    }\">\n        <el-table-column prop=\"staffId\" label=\"员工id\" min-width=\"80\" align=\"center\" />\n        <el-table-column prop=\"code\" label=\"工号\" min-width=\"125\" align=\"center\" />\n        <el-table-column prop=\"name\" label=\"姓名\" min-width=\"125\" align=\"center\" />\n        <el-table-column prop=\"deptName\" label=\"部门\" min-width=\"125\" align=\"center\" />\n        <el-table-column prop=\"phone\" label=\"电话\" min-width=\"125\" align=\"center\" />\n        <el-table-column v-for=\"index in dayNum\" :label=\"index + '日'\" :key=\"index\" min-width=\"55\">\n          <template slot-scope=\"scope\">\n            <div @click=\"changeStatus(scope.row, index - 1)\">\n              <el-tag :type=\"scope.row.attendanceList[index - 1].tagType\">\n                {{ scope.row.attendanceList[index - 1].message }}\n              </el-tag>\n            </div>\n          </template>\n        </el-table-column>\n      </el-table>\n      <el-pagination class=\"pager\" layout=\"total,sizes,prev,pager,next,jumper\"\n        :page-size=\"table.pageConfig.size ? table.pageConfig.size : 10\" :page-sizes=\"[5, 10, 15, 20]\"\n        :total=\"table.pageConfig.total\" :current-page.sync=\"table.pageConfig.current\" @size-change=\"handleSizeChange\"\n        @current-change=\"handleCurrentChange\"></el-pagination>\n    </div>\n  </div>\n</template>\n<script>\nimport { getAll, getByStaffIdAndDate, getExportApi, getImportApi, getList, setAttendance } from '../../../api/attendance'\nimport { mapState } from 'vuex'\nimport { getAllDept } from '@/api/dept'\n\nexport default {\n  name: 'Performance',\n  data() {\n    return {\n      dialog: {\n        isShow: false,\n        data: {},\n        status: '',\n        statusList: []\n      },\n      searchForm: {\n        deptList: [],\n        formData: {}\n      },\n      table: {\n        tableData: [],\n        pageConfig: {\n          total: 10, // 记录总数\n          current: 1, // 起始页\n          size: 10 // 每页展示的记录数\n        }\n      },\n      dayNum: 0,\n      month: ''\n    }\n  },\n  computed: {\n    ...mapState('token', ['token']),\n    headers() {\n      return { token: this.token }\n    },\n    // 获取导入数据的接口\n    importApi() {\n      return getImportApi()\n    }\n  },\n  methods: {\n    confirm() {\n      this.dialog.data.status = this.dialog.status\n      setAttendance(this.dialog.data).then(response => {\n        if (response.code === 200) {\n          this.loading()\n          this.$message.success('修改成功')\n          this.dialog.isShow = false\n        } else {\n          this.$message.error('修改失败')\n        }\n      })\n    },\n    changeStatus(row, i) {\n      getAll().then(response => {\n        if (response.code === 200) {\n          this.dialog.statusList = response.data\n        } else {\n          this.$message.error('获取数据失败')\n        }\n      })\n      getByStaffIdAndDate(row.staffId, row.attendanceList[i].attendanceDate).then(response => {\n        if (response.code === 200) {\n          this.dialog.data = response.data\n        } else {\n          this.dialog.data = {\n            staffId: row.staffId,\n            attendanceDate: row.attendanceList[i].attendanceDate\n          }\n        }\n      })\n      this.dialog.isShow = true\n      this.dialog.status = row.attendanceList[i].message\n    },\n    handleSizeChange(size) {\n      this.table.pageConfig.size = size\n      this.loading()\n    },\n    handleCurrentChange(current) {\n      this.table.pageConfig.current = current\n      this.loading()\n    },\n    search() {\n      this.loading()\n    },\n    // 重置搜索表单\n    reset() {\n      this.searchForm.formData = {}\n      this.loading()\n    },\n    // 将数据渲染到模板\n    loading() {\n      getAllDept().then(response => {\n        const list = []\n        response.data.forEach(dept => {\n          if (dept.children.length > 0) {\n            dept.disabled = true\n            list.push(dept)\n            dept.children.forEach(subDept => {\n              list.push(subDept)\n            })\n          }\n        })\n        this.searchForm.deptList = list\n      })\n      getList({\n        current: this.table.pageConfig.current,\n        size: this.table.pageConfig.size,\n        name: this.searchForm.formData.name,\n        deptId: this.searchForm.formData.deptId,\n        month: this.searchForm.formData.month\n      }).then(response => {\n        if (response.code === 200) {\n          this.table.tableData = response.data.list\n          console.log(this.table.tableData)\n          this.table.pageConfig.total = response.data.total\n          this.dayNum = response.data.dayNum\n          this.month = response.data.month\n        } else {\n          this.$message.error(response.message)\n        }\n      })\n    },\n    // 导出数据\n    exportData() {\n      window.open(getExportApi(this.month))\n    },\n    handleImportSuccess(response) {\n      if (response.code === 200) {\n        this.$message.success('数据导入成功！')\n        this.loading()\n      } else {\n        this.$message.error('数据导入失败！')\n        setTimeout(() => {\n          this.$message.error(response.message)\n        }, 50)\n      }\n    }\n  },\n  created() {\n    this.loading()\n  }\n}\n</script>\n<style lang=\"less\" scoped>\n.common-table {\n  height: calc(100% - 62px);\n  background-color: white;\n  position: relative;\n\n  .pager {\n    position: absolute;\n    bottom: 20px;\n    right: 20px;\n  }\n}\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=3e6f1a13&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=3e6f1a13&prod&lang=less&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3e6f1a13\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=3e6f1a13&prod&lang=less&scoped=true\"","import request from '../utils/request'\n\nconst url = '/dept'\n/**\n * 添加\n * @param data\n * @returns {AxiosPromise}\n */\nexport const add = (data) => {\n  return request({\n    url: url,\n    method: 'post',\n    data\n  })\n}\n\n/**\n * 逻辑删除\n * @param id\n * @returns {AxiosPromise}\n */\nexport const deleteOne = (id) => {\n  return request({\n    url: url + '/' + id,\n    method: 'delete'\n  })\n}\n\nexport const deleteBatch = (ids) => {\n  return request({\n    url: url + '/batch/' + ids,\n    method: 'delete'\n  })\n}\n\nexport const edit = (data) => {\n  return request({\n    url: url,\n    method: 'put',\n    data\n  })\n}\n\n// 分页条件查询\nexport const getList = (params) => {\n  return request({\n    url: url,\n    method: 'get',\n    params\n  })\n}\n\n// 查询所有\nexport const getAllDept = () => {\n  return request({\n    url: url + '/all'\n  })\n}\n\n// 得到一条数据\nexport const getOne = (id) => {\n  return request({\n    url: url + '/' + id\n  })\n}\n\n// 数据导入\nexport const getImportApi = () => {\n  return 'http://localhost:' + process.env.VUE_APP_PORT + url + '/import'\n}\n\n// 数据导出\nexport const getExportApi = () => {\n  return 'http://localhost:' + process.env.VUE_APP_PORT + url + '/export'\n}\n"],"sourceRoot":""}